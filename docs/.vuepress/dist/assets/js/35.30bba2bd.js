(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{380:function(t,a,n){"use strict";n.r(a);var s=n(40),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h3",{attrs:{id:"h5支付"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#h5支付"}},[t._v("#")]),t._v(" H5支付")]),t._v(" "),n("p",[t._v("前端的支付分两种，h5支付和Native支付")]),t._v(" "),n("p",[t._v("所谓的h5支付，是指商户在微信客户端外的移动端网页展示商品或服务，用户在前述页面确认使用微信支付时，商户发起本服务呼起微信客户端进行支付。")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://wxpay.wxutil.com/mch/pay/h5.v2.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信官方体验链接"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("流程图")]),t._v(" "),n("p",[n("img",{attrs:{src:"/zxz/images/projects/h5/chapter.png",alt:"流程图"}})]),t._v(" "),n("p",[t._v("1、用户在商户侧完成下单，使用微信支付进行支付")]),t._v(" "),n("p",[t._v("2、由商户后台向微信支付发起下单请求（调用统一下单接口）注：交易类型trade_type=MWEB")]),t._v(" "),n("p",[t._v('3、统一下单接口返回支付相关参数给商户后台，如支付跳转url（参数名"mweb_url"），商户通过mweb_url调起微信支付中间页')]),t._v(" "),n("p",[t._v("4、中间页进行H5权限的校验，安全性检查")]),t._v(" "),n("p",[t._v("5、如支付成功，商户后台会接收到微信侧的异步通知")]),t._v(" "),n("p",[t._v("6、用户在微信支付收银台完成支付或取消支付,返回商户页面（默认为返回支付发起页面）")]),t._v(" "),n("p",[t._v("7、商户在展示页面，引导用户主动发起支付结果的查询（弹窗或者轮询）")]),t._v(" "),n("p",[t._v("8、状态页面")]),t._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" mwebUrl "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 我们只需要处理第三步服务端返回的mwebUrl拼接redirect_url回调url（需对redirect_url进行urlencode处理）")]),t._v("\nwindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("mwebUrl"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("&redirect_url=")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURIComponent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("redirect_url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("p",[t._v("9、可能出现的错误码\n"),n("img",{attrs:{src:"/zxz/images/projects/h5/error.png",alt:"错误图"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);